"use strict";var SocialShare=SocialShare||{};$(document).ready(function(){!function(e){function a(e,a){if(!l[e])throw new Error("Share service not defined");var n=t(e,a);return o(n),this}function t(e,a){var t=l[e].shareurl,o=l[e].paramproto;a=a||{},"facebook"===e?a.u?a.u=i+a.u:a.u=i:"twitter"===e||(a.url?a.url=i+a.url:a.url=i),"linkedin"===e&&(a.mini&&"true"===a.mini||(a.mini="true"));var s=n(a,o),u=r(t,s);return u}function n(e,a){var t=[];e=e||{};for(var n in e)if(a.hasOwnProperty(n)){var r=a[n]+encodeURIComponent(e[n]);t.push(r)}return t}function r(e,a){a=a||[];var t=a.length?e+a.join("&"):e;return t}function o(e){var a=600,t=600,n=($(window).height()-t)/2,r=($(window).width()-a)/2,o="status=1,width="+a+",height="+t+",top="+n+",left="+r,i=e,l="_blank";return window.open(i,l,o),!1}var i=window.location.href,l={twitter:{shareurl:"http://twitter.com/intent/tweet?",paramproto:{text:"text=",url:"url=",hashtags:"hashtags=",via:"via=",related:"related="}},facebook:{shareurl:"http://www.facebook.com/sharer.php?",paramproto:{u:"u="}},linkedin:{shareurl:"http://www.linkedin.com/shareArticle?",paramproto:{url:"url=",mini:"mini=",title:"title=",summary:"summary=",source:"source="}},googleplus:{shareurl:"https://plus.google.com/share?",paramproto:{url:"url=",hl:"hl="}}};!function(){function e(e,a){return a=$.map(a,function(a,t){return e+"-"+a}),function(e){if(e){var t=$.map(a,function(e,a){return"."+e});return t.join(", ")}return a}}function t(e){function t(e){return $(this).hasClass(e)}var n=Array.prototype.slice.call($(this)[0].attributes),o={};$.each(n,function(e,a){var t=a.name,n=a.value;if(0===t.indexOf(r+"-")||0===t.indexOf("data-"+r+"-")){var i=t.split(r+"-")[1];o[i]=n}});var l=i.filter(t.bind(this));if(1===l.length){var s=l[0].split("-")[1];a(s,o)}}var n=Object.keys(l),r="share",o=e(r,n)(!0),i=e(r,n)(!1);$(o).on("click",t)}();var s={share:a};return e=$.extend(e,s)}(SocialShare)});var CHQ;d3.selection.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})};var es_ES={decimal:",",thousands:".",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],shortDays:["Dom","Lun","Mar","Mi","Jue","Vie","Sab"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],shortMonths:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"]},d3ES=d3.locale(es_ES);!function(e,a,t,n,r){CHQ={},CHQ.pymChild=pym.Child({polling:500}),CHQ.$body=t("body"),CHQ.init=function(){var e=CHQ.$body.width();CHQ.$body.css("min-height",9*e/16),n.init({key:"1upUGqPIAWsGpk00BecZbVpoWowPuGHm96pwPv_hppAs",callback:CHQ.dataLoaded,simpleSheet:!0,parseNumbers:!1}),CHQ.inIframe()?t(".iframe-show").show():t(".no-iframe-show").show()},CHQ.postProcess=function(e,a){return t.each(e,function(a,t){"anio"!=a&&"ente"!=a&&(e[a]=(e[a]+".").replace(/\./g,""),e[a]=parseInt(e[a]))}),e.id=a,e},CHQ.dataLoaded=function(e,a){CHQ.rawData=e.map(CHQ.postProcess),CHQ.$body.removeClass("loading"),CHQ.updateChart(),CHQ.render(),CHQ.startEvents()},CHQ.startEvents=function(){t(window).resize(function(){clearTimeout(CHQ.timeoutId),CHQ.timeoutId=setTimeout(CHQ.render,500)}),t("#anios").change(function(){CHQ.updateChart(t(this).val())})},CHQ.render=function(){var e=["value_GCBA","value_OA"];CHQ.totals=CHQ.rawData.map(function(e){return t.extend(e,{value_GCBA:0,value_OA:0,value_NACION:0}),e["value_"+e.ente]=e.patrimonio_total,e});c3.generate({bindto:"#chart-container",size:{height:480},data:{json:CHQ.totals,keys:{x:"anio",value:e},types:{value_GCBA:"bar",value_OA:"bar",patrimonio_total:"line"},colors:{value_GCBA:"#ffad5c",value_OA:"#ff8080",patrimonio_total:"#67508a"},groups:[["value_GCBA","value_OA"]],names:{value_GCBA:"Gobierno de la Ciudad de Buenos Aires",value_OA:"Oficina Anticorrupción"},onclick:function(e,a){t("#anios").val(e.index).change()}},point:{show:!1},tooltip:{grouped:!1,format:{value:d3ES.numberFormat("$,")}},axis:{x:{type:"category",tick:{rotate:90,multiline:!1},height:60},y:{label:{text:"Millones de pesos",position:"inner-top"},tick:{format:function(e){return"$"+e/1e6}}}},grid:{y:{lines:[{value:0}]}},onrendered:function(){setTimeout(function(){t("#anios").val("9").change(),t('#anios option[value="-1"]').remove()},2e3)}})},CHQ.updateChart=function(e){if(d3.selectAll("rect.c3-event-rect").classed("selected-chq",!1),d3.select("rect.c3-event-rect-"+e).classed("selected-chq",!0),e)var a=CHQ.rawData[e],n=[{anio:a.anio,label:"Bienes",value:a.bienes,icon:"bienes"},{anio:a.anio,label:"Acciones",value:a.acciones,icon:"acciones"},{anio:a.anio,label:"Ahorros",value:a.ahorros,icon:"ahorros"},{anio:a.anio,label:"Créditos",value:a.creditos,icon:"creditos"},{anio:a.anio,label:"Bienes del hogar",value:a.bienes_hogar,icon:"bienes_hogar"},{anio:a.anio,label:"Otros",value:a.otros,icon:"otros"},{anio:a.anio,label:"Bienes en el exterior",value:a.bienes_exterior,icon:"bienes_exterior"},{anio:a.anio,label:"Ahorros en el exterior",value:a.ahorros_exterior,icon:"ahorros_exterior"},{anio:a.anio,label:"Deudas",value:a.deudas,icon:"deudas"},{anio:a.anio,label:"Ingreso Mensual",value:a.ingreso_mensual_publico,icon:"ingreso_mensual_publico"}];else var n=[{anio:"",label:"Bienes",value:0,icon:"bienes"},{anio:"",label:"Acciones",value:0,icon:"acciones"},{anio:"",label:"Ahorros",value:0,icon:"ahorros"},{anio:"",label:"Créditos",value:0,icon:"creditos"},{anio:"",label:"Bienes del hogar",value:0,icon:"bienes_hogar"},{anio:"",label:"Otros",value:0,icon:"otros"},{anio:"",label:"Bienes en el exterior",value:0,icon:"bienes_exterior"},{anio:"",label:"Ahorros en el exterior",value:0,icon:"ahorros_exterior"},{anio:"",label:"Deudas",value:0,icon:"deudas"},{anio:"",label:"Ingreso Mensual",value:0,icon:"ingreso_mensual_publico"}];var r=d3.scale.ordinal().domain(d3.range(0,n.length)).range(["#00557C","#66B7DD","#11998C","#50D3C7","#5151B7","#DD8EDA","#94408C","#FCAF70","#ED5F5F","#AF1515"]),o=t("#chart-container").width(),i=o,l=60,s=d3.scale.linear().domain([0,d3.max(n,function(e){return parseInt(e.value)})]).range([0,i-l-100]),u=d3.select("#detail-chart").attr("width",i).attr("height",l*n.length),c=u.selectAll("g").data(n);c.enter().append("g").each(function(){d3.select(this).append("rect"),d3.select(this).append("text").classed("value",!0),d3.select(this).append("text").classed("label",!0),d3.select(this).append("svg:image").attr("xlink:href",function(e){return"images/icons/"+e.icon+".svg"}).attr("x",0).attr("y",0).attr("width",l).attr("height",l)}),c.attr("transform",function(e,a){return"translate(0,"+a*l+")"}),c.select("rect").attr("height",parseInt(l/2.5)).attr("y",l/3).attr("x",l).attr("fill",function(e,a){return r(a)}).transition().attr("width",function(e){var a="";return a=s(isNaN(e.value)?1:e.value)}),c.select("text.label").text(function(e){return e.label}).attr("y",parseInt(l/3)-4).transition().attr("x",l),c.select("text.value").text(function(e){var a="";return a=isNaN(e.value)?"Información no requerida en el año "+e.anio:d3ES.numberFormat("$,")(e.value)}).attr("y",l/2+7).attr("fill",function(e,a){var t="";return t=isNaN(e.value)?"#bbb":r(a)}).transition().attr("x",function(e){var a="";return a=isNaN(e.value)?l:s(e.value)+l+5})},CHQ.inIframe=function(){try{return window.self!==window.top}catch(e){return!0}}}(window,document,jQuery,Tabletop,Mustache);