"use strict";var SocialShare=SocialShare||{};$(document).ready(function(){!function(e){function t(e,t){if(!l[e])throw new Error("Share service not defined");var r=a(e,t);return o(r),this}function a(e,t){var a=l[e].shareurl,o=l[e].paramproto;t=t||{},"facebook"===e?t.u?t.u=i+t.u:t.u=i:"twitter"===e||(t.url?t.url=i+t.url:t.url=i),"linkedin"===e&&(t.mini&&"true"===t.mini||(t.mini="true"));var s=r(t,o),u=n(a,s);return u}function r(e,t){var a=[];e=e||{};for(var r in e)if(t.hasOwnProperty(r)){var n=t[r]+encodeURIComponent(e[r]);a.push(n)}return a}function n(e,t){t=t||[];var a=t.length?e+t.join("&"):e;return a}function o(e){var t=600,a=600,r=($(window).height()-a)/2,n=($(window).width()-t)/2,o="status=1,width="+t+",height="+a+",top="+r+",left="+n,i=e,l="_blank";return window.open(i,l,o),!1}var i=window.location.href,l={twitter:{shareurl:"http://twitter.com/intent/tweet?",paramproto:{text:"text=",url:"url=",hashtags:"hashtags=",via:"via=",related:"related="}},facebook:{shareurl:"http://www.facebook.com/sharer.php?",paramproto:{u:"u="}},linkedin:{shareurl:"http://www.linkedin.com/shareArticle?",paramproto:{url:"url=",mini:"mini=",title:"title=",summary:"summary=",source:"source="}},googleplus:{shareurl:"https://plus.google.com/share?",paramproto:{url:"url=",hl:"hl="}}};!function(){function e(e,t){return t=$.map(t,function(t,a){return e+"-"+t}),function(e){if(e){var a=$.map(t,function(e,t){return"."+e});return a.join(", ")}return t}}function a(e){function a(e){return $(this).hasClass(e)}var r=Array.prototype.slice.call($(this)[0].attributes),o={};$.each(r,function(e,t){var a=t.name,r=t.value;if(0===a.indexOf(n+"-")||0===a.indexOf("data-"+n+"-")){var i=a.split(n+"-")[1];o[i]=r}});var l=i.filter(a.bind(this));if(1===l.length){var s=l[0].split("-")[1];t(s,o)}}var r=Object.keys(l),n="share",o=e(n,r)(!0),i=e(n,r)(!1);$(o).on("click",a)}();var s={share:t};return e=$.extend(e,s)}(SocialShare)});var CHQ;d3.selection.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})};var es_ES={decimal:",",thousands:".",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],shortDays:["Dom","Lun","Mar","Mi","Jue","Vie","Sab"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],shortMonths:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"]},d3ES=d3.locale(es_ES);!function(e,t,a,r,n){CHQ={},CHQ.pymChild=pym.Child({polling:500}),CHQ.$body=a("body"),CHQ.init=function(){var e=CHQ.$body.width();CHQ.$body.css("min-height",9*e/16),r.init({key:"1upUGqPIAWsGpk00BecZbVpoWowPuGHm96pwPv_hppAs",callback:CHQ.dataLoaded,simpleSheet:!0,parseNumbers:!0}),CHQ.inIframe()?a(".iframe-show").show():a(".no-iframe-show").show()},CHQ.postProcess=function(e,t){return a.each(e,function(t,a){"anio"!=t&&"ente"!=t&&(e[t]=(e[t]+"").replace(/\./g,""),e[t]=parseInt(e[t]))}),e.id=t,e},CHQ.dataLoaded=function(e,t){CHQ.rawData=e.map(CHQ.postProcess),console.log("data",CHQ.rawData),CHQ.$body.removeClass("loading"),CHQ.render(),setTimeout(CHQ.startEvents,2e3)},CHQ.startEvents=function(){a(window).resize(function(){clearTimeout(CHQ.timeoutId),CHQ.timeoutId=setTimeout(CHQ.render,500)}),a("#anios").change(function(){CHQ.updateChart(a(this).val())})},CHQ.render=function(){var e=["value_GCBA","value_OA","patrimonio_total"];CHQ.totals=CHQ.rawData.map(function(e){return a.extend(e,{value_GCBA:0,value_OA:0,value_NACION:0}),e["value_"+e.ente]=e.patrimonio_total,e});c3.generate({bindto:"#chart-container",data:{json:CHQ.totals,keys:{x:"anio",value:e},types:{value_GCBA:"bar",value_OA:"bar",patrimonio_total:"line"},colors:{value_GCBA:"#FFBD00",value_OA:"#1A80C2",patrimonio_total:"#aaa"},groups:[["value_GCBA","value_OA"]],names:{value_GCBA:"GCBA",value_OA:"OA",patrimonio_total:"Patrimonio total"},onclick:function(e,t){a("#anios").val(e.index).change()}},point:{show:!1},tooltip:{grouped:!1,format:{value:d3ES.numberFormat("$,")}},axis:{x:{type:"category",tick:{rotate:90}},y:{tick:{format:function(e){return"$"+e/1e6}}}},grid:{y:{lines:[{value:0}]}},onrendered:function(){setTimeout(function(){a("#anios").val("9").change(),a('#anios option[value="-1"]').remove()},2e3)}})},CHQ.updateChart=function(e){d3.selectAll("rect.c3-event-rect").classed("selected-chq",!1),d3.select("rect.c3-event-rect-"+e).classed("selected-chq",!0);var t=CHQ.rawData[e],r=[{label:"Bienes",value:t.bienes,icon:"bienes"},{label:"Acciones",value:t.acciones,icon:"acciones"},{label:"Ahorros",value:t.ahorros,icon:"ahorros"},{label:"Créditos",value:t.creditos,icon:"creditos"},{label:"Bienes del hogar",value:t.bienes_hogar,icon:"bienes_hogar"},{label:"Otros",value:t.otros,icon:"otros"},{label:"Bienes en el exterior",value:t.bienes_exterior,icon:"bienes_exterior"},{label:"Ahorros en el exterior",value:t.ahorros_exterior,icon:"ahorros_exterior"},{label:"Deudas",value:t.deudas,icon:"deudas"},{label:"Ingreso Mensual",value:t.ingreso_mensual_publico,icon:"ingreso_mensual_publico"}],n=d3.scale.ordinal().domain(d3.range(0,r.length)).range(["#00557C","#66B7DD","#11998C","#50D3C7","#5151B7","#DD8EDA","#94408C","#FCAF70","#ED5F5F","#AF1515"]),o=a("#chart-container").width(),i=o,l=70,s=d3.scale.linear().domain([0,d3.max(r,function(e){return parseInt(e.value)})]).range([0,i-l-100]),u=d3.select("#detail-chart").attr("width",i).attr("height",l*r.length),c=u.selectAll("g").data(r);c.enter().append("g").each(function(){d3.select(this).append("rect"),d3.select(this).append("text").classed("value",!0),d3.select(this).append("text").classed("label",!0),d3.select(this).append("svg:image").attr("xlink:href",function(e){return"images/icons/"+e.icon+".svg"}).attr("x",0).attr("y",0).attr("width",l).attr("height",l)}),c.attr("transform",function(e,t){return"translate(0,"+t*l+")"}),c.select("rect").attr("height",l/3).attr("y",l/2).attr("x",l).attr("fill",function(e,t){return n(t)}).transition().attr("width",function(e){return s(e.value)}),c.select("text.label").text(function(e){return e.label}).attr("y",l/2-5).transition().attr("x",l),c.select("text.value").text(function(e){return isNaN(e.value)?"":d3ES.numberFormat("$,")(e.value)}).attr("y",l-17).attr("fill",function(e,t){return n(t)}).transition().attr("x",function(e){return s(e.value)+l+5})},CHQ.inIframe=function(){try{return window.self!==window.top}catch(e){return!0}}}(window,document,jQuery,Tabletop,Mustache);